# Render service definitions for Website Intelligence Platform
services:
  # ---------- Backend API ----------
  - type: web
    name: ai-intel-backend
    env: docker
    repo: https://github.com/Joeches/Website-Intelligence-Platform
    branch: main
    dockerfilePath: Dockerfile   # âœ… points to backend Dockerfile
    plan: starter
    autoDeploy: true

    # Commands handled inside Dockerfile
    buildCommand: ""
    startCommand: "uvicorn main:app --host 0.0.0.0 --port $PORT"

    healthCheckPath: /health
    scale:
      minInstances: 1
      maxInstances: 3

    envVars:
      - key: FIREBASE_PROJECT_ID
        sync: false
      - key: FIREBASE_CLIENT_EMAIL
        sync: false
      - key: FIREBASE_PRIVATE_KEY
        sync: false
      - key: FIREBASE_DATABASE_URL
        sync: false
      - key: STRIPE_API_KEY
        sync: false
      - key: STRIPE_WEBHOOK_SECRET
        sync: false
      - key: HUGGINGFACE_API_TOKEN
        sync: false
      - key: GROQ_API_KEY
        sync: false
      - key: ALLOWED_ORIGINS
        sync: false

  # ---------- Worker ----------
  - type: worker
    name: ai-intel-worker
    env: docker
    repo: https://github.com/Joeches/Website-Intelligence-Platform
    branch: main
    dockerfilePath: backend/Dockerfile
    plan: starter
    autoDeploy: true

    startCommand: "python worker.py"

    envVars:
      - key: FIREBASE_PROJECT_ID
        sync: false
      - key: FIREBASE_CLIENT_EMAIL
        sync: false
      - key: FIREBASE_PRIVATE_KEY
        sync: false
      - key: FIREBASE_DATABASE_URL
        sync: false
      - key: STRIPE_API_KEY
        sync: false
      - key: STRIPE_WEBHOOK_SECRET
        sync: false
      - key: HUGGINGFACE_API_TOKEN
        sync: false
      - key: GROQ_API_KEY
        sync: false
      - key: ALLOWED_ORIGINS
        sync: false
